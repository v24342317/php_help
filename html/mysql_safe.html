<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="zh-cn" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<title>MySQL安全问题（攻防必知） - 雪山飞猪 - 博客园</title>
<link href="mysql_safe/blog-common.css" rel="stylesheet" type="text/css">
<link href="mysql_safe/bundle-UnlimitedSunlight.css" rel="stylesheet" type="text/css" id="MainCss">



</head>
<body>

<!--done-->
<div id="home"><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
<div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a href="http://www.cnblogs.com/chenqionghe/p/4873665.html" class="postTitle2" id="cb_post_title_url">MySQL安全问题（攻防必知）</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body"><p><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 对于任何一种数据库来说，安全问题都是非常重要的。如果数据库出现安全漏洞，轻则数据被窃取，重则数据被破坏，这些后果对于一些重要的数据库都是非常严重的。下面来从操作系统和数据库两个层对MySQL的安全问题进行讨论。</span></p>
<div><span style="font-family: 微软雅黑;">&nbsp;</span></div>
<h2><span style="font-family: 微软雅黑;"><span data-wiz-span="data-wiz-span"><strong><span data-wiz-span="data-wiz-span">操作系统相关的安全问题</span></strong></span></span></h2>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 常见的操作系统安全问题主要出现在MySQL的安装和启动过程中.</span><span style="font-family: 微软雅黑;"><br></span></div>
<h3><span style="font-family: 微软雅黑;"><strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 1.严格控制操作系统账号和权限</span></strong></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 在数据库服务器上要严格控制操作系统的账号和权限，比如：</span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<ul>
<li>锁定mysql用户</li>
<li>其他任何用户都采取独立的账号登录，管理员通过mysql专有用户管理MySQL，或者通过root su到mysql用户下进行管理。</li>
<li>mysql用户目录下，除了数据文件目录，其他文件和目录属主都改为root</li>





</ul>





</div>
<h3><strong><span style="font-family: 微软雅黑;"><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 2.尽量避免以root权限运行MySQL</span></span><span style="font-family: 微软雅黑;"><br></span></strong></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 
MySQL安装完毕后，一般会将数据目录属主设置为mysql用户，而将MySQL软件目录的属主设置为root，这样做的目的是当使用mysql启动数
据库时，可以防止任何具有FILE权限的用户能够用root创建文件。而如果使用root用户启动数据库，则任何具有FILE权限的用户都可以读写
root用户的文件，这样会给系统造成严重的安全隐患。</span><span style="font-family: 微软雅黑;"><br></span></div>
<h3><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong><span data-wiz-span="data-wiz-span">3.防止DNS欺骗</span></strong></span></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 创建用户时，host可以指定域名或者IP地址。但是，如果指定域名，就可能带来如下安全隐患：</span>&nbsp; 如果域名对应的IP地址被恶意修改，则数据库就会被恶意的IP地址进行访问，导致安全隐患。<span style="font-family: 微软雅黑;"><br></span></div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<h2><strong><span data-wiz-span="data-wiz-span">数据库相关的安全问题</span></strong></h2>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 常见的数据库问题大多数是由于账号的管理不当造成的。应该加强对账号管理的安全意识。</span></div>
<h3><span style="font-family: 微软雅黑;"><strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 1.删除匿名账号</span></strong></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 
在某些版本的中，安装完毕MySQL后，会自动安装一个空账号，此账号具有对test数据库的全部权限，普通用户只需要执行mysql命令即可登录
MySQL数据库，这个时候默认使用了空用户，可以在test数据库里面做各种操作，比如可以创建一个大表，占用大量磁盘空间，这样给系统造成了安全隐
患。</span><span style="font-family: 微软雅黑;"><br></span></div>
<h3><span style="font-family: 微软雅黑;"><span data-wiz-span="data-wiz-span">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>2.给root账号设置口令</strong></span></span></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; MySQL安装完毕后，root默认口令为空，需要马上修改口令</span></div>
<div>
<div class="linenums">
<div class="L0">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_119830"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql keyword">set</code> <code class="sql keyword">password</code><code class="sql plain">=</code><code class="sql keyword">password</code><code class="sql plain">(</code><code class="sql string">'newpassword'</code><code class="sql plain">);</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
</div>
<h3><span style="font-family: 微软雅黑;"><strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 3.设置安全密码</span></strong></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 密码的安全体现在以下两个方面：</span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<ul>
<li>设置安全的密码，建议使用6位以上字母、数字、下划线和一些特殊字符组合的而成的字符串；</li>
<li>使用上的安全，使用密码期间尽量保证使用过程安全，不会被别人窃取。</li>





</ul>





</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 第一点就不用说了，越长越复杂越没有规律的密码越安全。对于第二点，可以总结一下，在日常工作中，使用密码一般是采用以下几种方式。</span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（1）</strong>直接将密码写在命令行中。</span></span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div class="linenums">
<div class="L0">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_617527"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql -uroot -p123</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;&nbsp;</span><strong>（2）</strong>交互式方式输入密码。</div>
<div>
<div class="linenums">
<div class="L0">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_652223"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql -uroot -p</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（3）</strong>将用户名和密码写在配置文件里面，连接的时候自动读取，比如应用连接数据库或者执行一些批处理脚本。对于这种方式，MySQL供了一种方法，在my.cnf里面写入连接信息。</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_145271"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[client]</code></div><div class="line number2 index1 alt1"><code class="sql color2">user</code><code class="sql plain">=username</code></div><div class="line number3 index2 alt2"><code class="sql keyword">password</code><code class="sql plain">=</code><code class="sql keyword">password</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div>然后对配置文件进行严格的权限限制，例如：</div>
<div>
<div>
<div class="linenums">
<div class="L0">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_535984"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">chomod +600 my.cnf</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 
以上是3种常见的密码使用方式。很显然，第1种最不安全，因为它将密码写成为明文；第2种比较安全，但是只能使用在交互的界面下；第3种比较方便，但是需
要将配置文件设置严格的存取权限，而且任何只要可以登录操作系统的用户都可能自动登录，存在一定的安全隐患。</span></div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 第3种方法通常使用不多，下面举一个例子</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（1）</strong>输入mysql无法登录。</span></span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_70730"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql</code></div><div class="line number2 index1 alt1"><code class="sql plain">ERROR 1045 (28000): Access denied </code><code class="sql keyword">for</code> <code class="sql color2">user</code> <code class="sql string">'root'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code> <code class="sql plain">(using </code><code class="sql keyword">password</code><code class="sql plain">: </code><code class="sql keyword">NO</code><code class="sql plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（2）</strong>修改配置文件，加入连接信息</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_189370"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# vim /etc/my.cnf </code></div><div class="line number2 index1 alt1"><code class="sql plain">...</code></div><div class="line number3 index2 alt2"><code class="sql plain">[client]</code></div><div class="line number4 index3 alt1"><code class="sql plain">#</code><code class="sql keyword">password</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="sql plain">= your_password</code></div><div class="line number5 index4 alt2"><code class="sql color2">user</code><code class="sql plain">=cqh</code></div><div class="line number6 index5 alt1"><code class="sql keyword">password</code><code class="sql plain">=123</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（3）</strong>重启数据库后，输入mysql</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_582998"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# service mysqld restart</code></div><div class="line number2 index1 alt1"><code class="sql plain">Shutting down MySQL... SUCCESS! </code></div><div class="line number3 index2 alt2"><code class="sql plain">Starting MySQL.. SUCCESS! </code></div><div class="line number4 index3 alt1"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql</code></div><div class="line number5 index4 alt2"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">1</code></div><div class="line number7 index6 alt2"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number8 index7 alt1"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number10 index9 alt1"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number11 index10 alt2"><code class="sql plain">owners.</code></div><div class="line number12 index11 alt1"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number13 index12 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">select</code> <code class="sql color2">current_user</code><code class="sql plain">();</code></div><div class="line number14 index13 alt1"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number15 index14 alt2"><code class="sql plain">| </code><code class="sql color2">current_user</code><code class="sql plain">() |</code></div><div class="line number16 index15 alt1"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number17 index16 alt2"><code class="sql plain">| cqh@localhost&nbsp; |</code></div><div class="line number18 index17 alt1"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number19 index18 alt2"><code class="sql plain">1 row </code><code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.02 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<h3><span style="font-family: 微软雅黑;"><strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 4.只授予账号必须的权限</span></strong></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 只需要赋予普通用户必须的权限，比如：</span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div class="linenums">
<div class="L0">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_309452"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql keyword">grant</code> <code class="sql keyword">select</code><code class="sql plain">,</code><code class="sql keyword">insert</code><code class="sql plain">,</code><code class="sql keyword">update</code><code class="sql plain">,</code><code class="sql keyword">delete</code> <code class="sql keyword">on</code> <code class="sql plain">tablename </code><code class="sql keyword">to</code> <code class="sql string">'username'</code><code class="sql plain">@</code><code class="sql string">'hostname'</code><code class="sql plain">;</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 在很多情况下，DBA由于图方便，而经常赋予用户all privileges权限，这个all privileges到底具体包含哪些权限呢？来看下面的例子：</span></div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_802935"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">select</code> <code class="sql plain">* </code><code class="sql keyword">from</code> <code class="sql plain">db </code><code class="sql keyword">where</code> <code class="sql color2">user</code><code class="sql plain">=</code><code class="sql string">'cqh'</code><code class="sql plain">\G</code></div><div class="line number2 index1 alt1"><code class="sql plain">*************************** 1. row ***************************</code></div><div class="line number3 index2 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Host: localhost</code></div><div class="line number4 index3 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Db: test</code></div><div class="line number5 index4 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql color2">User</code><code class="sql plain">: cqh</code></div><div class="line number6 index5 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Select_priv: Y</code></div><div class="line number7 index6 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Insert_priv: Y</code></div><div class="line number8 index7 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Update_priv: Y</code></div><div class="line number9 index8 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Delete_priv: Y</code></div><div class="line number10 index9 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Create_priv: Y</code></div><div class="line number11 index10 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Drop_priv: Y</code></div><div class="line number12 index11 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Grant_priv: N</code></div><div class="line number13 index12 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">References_priv: Y</code></div><div class="line number14 index13 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Index_priv: Y</code></div><div class="line number15 index14 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Alter_priv: Y</code></div><div class="line number16 index15 alt1"><code class="sql plain">Create_tmp_table_priv: Y</code></div><div class="line number17 index16 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Lock_tables_priv: Y</code></div><div class="line number18 index17 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Create_view_priv: Y</code></div><div class="line number19 index18 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Show_view_priv: Y</code></div><div class="line number20 index19 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">Create_routine_priv: Y</code></div><div class="line number21 index20 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Alter_routine_priv: Y</code></div><div class="line number22 index21 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Execute_priv: Y</code></div><div class="line number23 index22 alt2"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Event_priv: Y</code></div><div class="line number24 index23 alt1"><code class="sql spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="sql plain">Trigger_priv: Y</code></div><div class="line number25 index24 alt2"><code class="sql plain">1 row </code><code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; all privileges里面的权限，远远超过了我们一般应用所需要的权限。而且，有些权限如果误操作，将会产生非常严重的后果，比如drop_priv等。因此，用户权限的时候越具体，则对数据库越安全。</span></div>
</div>
<h3><span style="font-family: 微软雅黑;"><strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 5.除root外，任何用户不应有mysql库user表的存取权限</span></strong></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 
由于MySQL中可以通过更改mysql数据库的user表进行权限的增加、删除、变更等操作，因此，除了root以外，任何用户都不应该拥有对user
表的存取权限（SELECT、UPDATE、INSERT、DELETE等），造成系统的安全隐患。下例对普通用户cqh授予user表的存取权限，看看
会对系统产生了怎么样的安全隐患。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（1）</strong>创建普通用户chenqionghe，拥有对mysql数据库中的user表的各种权限。</span></span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_118355"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -uroot -p</code></div><div class="line number2 index1 alt1"><code class="sql plain">Enter </code><code class="sql keyword">password</code><code class="sql plain">: </code></div><div class="line number3 index2 alt2"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number4 index3 alt1"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">103</code></div><div class="line number5 index4 alt2"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number6 index5 alt1"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number7 index6 alt2"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number8 index7 alt1"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number9 index8 alt2"><code class="sql plain">owners.</code></div><div class="line number10 index9 alt1"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number11 index10 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">grant</code> <code class="sql keyword">select</code><code class="sql plain">,</code><code class="sql keyword">update</code><code class="sql plain">,</code><code class="sql keyword">insert</code><code class="sql plain">,</code><code class="sql keyword">delete</code> <code class="sql keyword">on</code> <code class="sql plain">mysql.</code><code class="sql color2">user</code> <code class="sql keyword">to</code> <code class="sql plain">chenqionghe@localhost;</code></div><div class="line number12 index11 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（2）</strong>用chenqionghe来更新root权限。</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_155610"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -uchenqionghe</code></div><div class="line number2 index1 alt1"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number3 index2 alt2"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">106</code></div><div class="line number4 index3 alt1"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number5 index4 alt2"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number7 index6 alt2"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number8 index7 alt1"><code class="sql plain">owners.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number10 index9 alt1"><code class="sql plain">mysql&gt; use mysql;</code></div><div class="line number11 index10 alt2"><code class="sql keyword">Database</code> <code class="sql plain">changed</code></div><div class="line number12 index11 alt1"><code class="sql plain">mysql&gt; </code></div><div class="line number13 index12 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">update</code> <code class="sql color2">user</code> <code class="sql keyword">set</code> <code class="sql keyword">password</code><code class="sql plain">=</code><code class="sql keyword">password</code><code class="sql plain">(</code><code class="sql string">'abcd'</code><code class="sql plain">) </code><code class="sql keyword">where</code> <code class="sql color2">user</code><code class="sql plain">=</code><code class="sql string">'root'</code> <code class="sql color1">and</code> <code class="sql plain">host=</code><code class="sql string">'localhost'</code><code class="sql plain">;</code></div><div class="line number14 index13 alt1"><code class="sql plain">Query OK, 1 row affected (0.00 sec)</code></div><div class="line number15 index14 alt2"><code class="sql keyword">Rows</code> <code class="sql plain">matched: 1&nbsp; Changed: 1&nbsp; Warnings: 0</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（3）</strong>当数据库重启或者root刷新权限表后，root登录时密码已经被更改。</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_132180"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -uroot -pabcd</code></div><div class="line number2 index1 alt1"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number3 index2 alt2"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">2</code></div><div class="line number4 index3 alt1"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number5 index4 alt2"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number7 index6 alt2"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number8 index7 alt1"><code class="sql plain">owners.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<h3><span style="font-family: 微软雅黑;"><span data-wiz-span="data-wiz-span"><strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 6.不要把FILE、PROCESS或SUPER权限授予管理员以外的账号</span></strong></span></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; FILE权限主要以下作用：</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">将数据库的信息通过SELECT ...INTO OUTFILE...写到服务器上有写权限的目录下，作为文本格式存放。具有权限的目录也就是启动MySQL时的用户权限目录。</span></div>
<div><span style="font-family: 微软雅黑;">可以将有读权限的文本文件通过LOAD DATA INFILE...命令写入数据表，如果这些表中存放了很重要的信息，将对系统造成很大的安全隐患。</span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 在例中详细描述了FILE权限可能造成的隐患。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（1）</strong>连接数据库并创建测试表t。</span></span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_670538"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -uroot -p</code></div><div class="line number2 index1 alt1"><code class="sql plain">Enter </code><code class="sql keyword">password</code><code class="sql plain">: </code></div><div class="line number3 index2 alt2"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number4 index3 alt1"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">8</code></div><div class="line number5 index4 alt2"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number6 index5 alt1"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number7 index6 alt2"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number8 index7 alt1"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number9 index8 alt2"><code class="sql plain">owners.</code></div><div class="line number10 index9 alt1"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number11 index10 alt2"><code class="sql plain">mysql&gt; use test;</code></div><div class="line number12 index11 alt1"><code class="sql keyword">Database</code> <code class="sql plain">changed</code></div><div class="line number13 index12 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">create</code> <code class="sql keyword">table</code> <code class="sql plain">t (</code><code class="sql keyword">name</code> <code class="sql keyword">varchar</code><code class="sql plain">(500));</code></div><div class="line number14 index13 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.02 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（2）</strong>将/etc/password文件加载到表t中</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_199179"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">load</code> <code class="sql plain">data infile </code><code class="sql string">'/etc/passwd'</code> <code class="sql keyword">into</code> <code class="sql keyword">table</code> <code class="sql plain">t;</code></div><div class="line number2 index1 alt1"><code class="sql plain">Query OK, 23 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.01 sec)</code></div><div class="line number3 index2 alt2"><code class="sql plain">Records: 23&nbsp; Deleted: 0&nbsp; Skipped: 0&nbsp; Warnings: 0</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div>&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（3）</strong>查看t的内容</span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_313318"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">select</code> <code class="sql plain">* </code><code class="sql keyword">from</code> <code class="sql plain">t;</code></div><div class="line number2 index1 alt1"><code class="sql plain">+</code><code class="sql comments">----------------------------------------------------------------------+</code></div><div class="line number3 index2 alt2"><code class="sql plain">| </code><code class="sql keyword">name</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 <code class="sql plain">|</code></div><div class="line number4 index3 alt1"><code class="sql plain">+</code><code class="sql comments">----------------------------------------------------------------------+</code></div><div class="line number5 index4 alt2"><code class="sql plain">|
 
root:x:0:0:root:/root:/bin/bash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number6 index5 alt1"><code class="sql plain">|
 
bin:x:1:1:bin:/bin:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number7 index6 alt2"><code class="sql plain">|
 
daemon:x:2:2:daemon:/sbin:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number8 index7 alt1"><code class="sql plain">|
 
adm:x:3:4:adm:/var/adm:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number9 index8 alt2"><code class="sql plain">|
 
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number10 index9 alt1"><code class="sql plain">|
 
sync:x:5:0:sync:/sbin:/bin/sync&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number11 index10 alt2"><code class="sql plain">|
 
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number12 index11 alt1"><code class="sql plain">|
 
halt:x:7:0:halt:/sbin:/sbin/halt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number13 index12 alt2"><code class="sql plain">|
 
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number14 index13 alt1"><code class="sql plain">|
 
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number15 index14 alt2"><code class="sql plain">|
 
operator:x:11:0:operator:/root:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number16 index15 alt1"><code class="sql plain">|
 
games:x:12:100:games:/usr/games:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number17 index16 alt2"><code class="sql plain">|
 
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number18 index17 alt1"><code class="sql plain">| ftp:x:14:50:FTP </code><code class="sql color2">User</code><code class="sql plain">:/var/ftp:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number19 index18 alt2"><code class="sql plain">|
 
nobody:x:99:99:Nobody:/:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number20 index19 alt1"><code class="sql plain">| vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number21 index20 alt2"><code class="sql plain">|
 
ntp:x:38:38::/etc/ntp:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number22 index21 alt1"><code class="sql plain">| saslauth:x:499:76:</code><code class="sql string">"Saslauthd user"</code><code class="sql plain">:/var/empty/saslauth:/sbin/nologin |</code></div><div class="line number23 index22 alt2"><code class="sql plain">|
 
postfix:x:89:89::/var/spool/postfix:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number24 index23 alt1"><code class="sql plain">| sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin&nbsp;&nbsp; |</code></div><div class="line number25 index24 alt2"><code class="sql plain">|
 nscd:x:28:28:NSCD 
Daemon:/:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number26 index25 alt1"><code class="sql plain">|
 
www:x:500:500::/alidata/www:/sbin/nologin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number27 index26 alt2"><code class="sql plain">| mysql:x:501:501::/home/mysql:/sbin/nologin&nbsp;&nbsp; </code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">这样，重要的用户信息/etc/passwd内容将被写入表t中，造成安全隐患。</span></div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; PROCESS权限能被用来执行“show
 processlist”命令，查看当前所有用户执行的查询的明文文本，包括设定或改变密码的查询。在默认情况下，每个用户都可以执行“show 
processlist”命令，但是只能查询本用户的进程。因此，对PROCESS权限管理不当，有可能会使得普通用户能够看到管理员执行的命令。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 下例中对普通用户赋予了PROCESS权限，来看看会造成什么安全隐患。</span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（1）</strong>将PROCESS权限授予给普通用户：</span></span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_469241"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -uroot -p</code></div><div class="line number2 index1 alt1"><code class="sql plain">Enter </code><code class="sql keyword">password</code><code class="sql plain">: </code></div><div class="line number3 index2 alt2"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number4 index3 alt1"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">26</code></div><div class="line number5 index4 alt2"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number6 index5 alt1"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number7 index6 alt2"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number8 index7 alt1"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number9 index8 alt2"><code class="sql plain">owners.</code></div><div class="line number10 index9 alt1"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number11 index10 alt2"><code class="sql plain">mysql&gt; show processlist;</code></div><div class="line number12 index11 alt1"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+------+---------+------+-------+------------------+</code></div><div class="line number13 index12 alt2"><code class="sql plain">| Id | </code><code class="sql color2">User</code> <code class="sql plain">| Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | db&nbsp;&nbsp; | Command | </code><code class="sql keyword">Time</code> <code class="sql plain">| State | Info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number14 index13 alt1"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+------+---------+------+-------+------------------+</code></div><div class="line number15 index14 alt2"><code class="sql plain">|&nbsp; 2 | root | localhost | </code><code class="sql color1">NULL</code> <code class="sql plain">| Sleep&nbsp;&nbsp; |&nbsp;&nbsp; 53 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </code><code class="sql color1">NULL</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="sql plain">|</code></div><div class="line number16 index15 alt1"><code class="sql plain">| 26 | root | localhost | </code><code class="sql color1">NULL</code> <code class="sql plain">| Query&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 0 | </code><code class="sql color1">NULL</code>&nbsp; <code class="sql plain">| show processlist |</code></div><div class="line number17 index16 alt2"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+------+---------+------+-------+------------------+</code></div><div class="line number18 index17 alt1"><code class="sql plain">2 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div><div class="line number19 index18 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">grant</code> <code class="sql plain">process </code><code class="sql keyword">on</code> <code class="sql plain">*.* </code><code class="sql keyword">to</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code><code class="sql plain">;</code></div><div class="line number20 index19 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（2）</strong>锁定表user，可以让进程阻塞，以方便用户看到进程内容：</span></span></div>
</div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_220864"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; lock </code><code class="sql keyword">table</code> <code class="sql color2">user</code> <code class="sql keyword">read</code><code class="sql plain">;</code></div><div class="line number2 index1 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（3）</strong>打开另外一个session，用root执行修改密码操作，此时因为user表被锁定，此进程被阻塞挂起</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_124477"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -uroot -p</code></div><div class="line number2 index1 alt1"><code class="sql plain">Enter </code><code class="sql keyword">password</code><code class="sql plain">: </code></div><div class="line number3 index2 alt2"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number4 index3 alt1"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">27</code></div><div class="line number5 index4 alt2"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number6 index5 alt1"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number7 index6 alt2"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number8 index7 alt1"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number9 index8 alt2"><code class="sql plain">owners.</code></div><div class="line number10 index9 alt1"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number11 index10 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">set</code> <code class="sql keyword">password</code><code class="sql plain">=</code><code class="sql keyword">password</code><code class="sql plain">(</code><code class="sql string">'123'</code><code class="sql plain">);</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（4）</strong>打开第3个session，用cqh登录，执行show processlist语句：</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_749286"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -ucqh</code></div><div class="line number2 index1 alt1"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number3 index2 alt2"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">31</code></div><div class="line number4 index3 alt1"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number5 index4 alt2"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number7 index6 alt2"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number8 index7 alt1"><code class="sql plain">owners.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number10 index9 alt1"><code class="sql plain">mysql&gt; show processlist;</code></div><div class="line number11 index10 alt2"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number12 index11 alt1"><code class="sql plain">| Id | </code><code class="sql color2">User</code> <code class="sql plain">| Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | db&nbsp;&nbsp;&nbsp; | Command | </code><code class="sql keyword">Time</code> <code class="sql plain">|
 
State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 | 
Info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number13 index12 alt2"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number14 index13 alt1"><code class="sql plain">|
 26 | root | localhost | mysql | Sleep&nbsp;&nbsp; |&nbsp;&nbsp; 20 
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 | </code><code class="sql color1">NULL</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 <code class="sql plain">|</code></div><div class="line number15 index14 alt2"><code class="sql plain">| 27 | root | localhost | </code><code class="sql color1">NULL</code>&nbsp; <code class="sql plain">| Query&nbsp;&nbsp; |&nbsp;&nbsp; 15 | Waiting </code><code class="sql keyword">for</code> <code class="sql keyword">table</code> <code class="sql keyword">level</code> <code class="sql plain">lock | </code><code class="sql keyword">set</code> <code class="sql keyword">password</code><code class="sql plain">=</code><code class="sql keyword">password</code><code class="sql plain">(</code><code class="sql string">'123'</code><code class="sql plain">) |</code></div><div class="line number16 index15 alt1"><code class="sql plain">| 31 | cqh&nbsp; | localhost | </code><code class="sql color1">NULL</code>&nbsp; <code class="sql plain">| Query&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 0 | </code><code class="sql color1">NULL</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 <code class="sql plain">| show processlist&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number17 index16 alt2"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number18 index17 alt1"><code class="sql plain">3 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 可以发现，cqh显示的进程中清楚地看到了root的修改密码操作，并看到了明文的密码，这将对系统造成严重的安全隐患。</span></div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; SUPER权限能够执行kill命令，终止其他用户进程。下面例子中，普通用户拥有了SUPER权限后，便可以任意kill任何用户的进程。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（1）</strong>cqh登录后想kill掉root修改密码进程（进程号27)</span></span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_78724"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; show processlist;</code></div><div class="line number2 index1 alt1"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number3 index2 alt2"><code class="sql plain">| Id | </code><code class="sql color2">User</code> <code class="sql plain">| Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | db&nbsp;&nbsp;&nbsp; | Command | </code><code class="sql keyword">Time</code> <code class="sql plain">|
 
State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 | 
Info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number4 index3 alt1"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number5 index4 alt2"><code class="sql plain">|
 26 | root | localhost | mysql | Sleep&nbsp;&nbsp; |&nbsp;&nbsp; 20 
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 | </code><code class="sql color1">NULL</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 <code class="sql plain">|</code></div><div class="line number6 index5 alt1"><code class="sql plain">| 27 | root | localhost | </code><code class="sql color1">NULL</code>&nbsp; <code class="sql plain">| Query&nbsp;&nbsp; |&nbsp;&nbsp; 15 | Waiting </code><code class="sql keyword">for</code> <code class="sql keyword">table</code> <code class="sql keyword">level</code> <code class="sql plain">lock | </code><code class="sql keyword">set</code> <code class="sql keyword">password</code><code class="sql plain">=</code><code class="sql keyword">password</code><code class="sql plain">(</code><code class="sql string">'123'</code><code class="sql plain">) |</code></div><div class="line number7 index6 alt2"><code class="sql plain">| 31 | cqh&nbsp; | localhost | </code><code class="sql color1">NULL</code>&nbsp; <code class="sql plain">| Query&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 0 | </code><code class="sql color1">NULL</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 <code class="sql plain">| show processlist&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number8 index7 alt1"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number9 index8 alt2"><code class="sql plain">3 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div><div class="line number10 index9 alt1"><code class="sql plain">mysql&gt; kill 27;</code></div><div class="line number11 index10 alt2"><code class="sql plain">ERROR 1095 (HY000): You are </code><code class="sql color1">not</code> <code class="sql plain">owner </code><code class="sql keyword">of</code> <code class="sql plain">thread 27</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（2）</strong>kill失败后，root将super权限赋予cqh;</span></span></div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_639642"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">grant</code> <code class="sql plain">super </code><code class="sql keyword">on</code> <code class="sql plain">*.* </code><code class="sql keyword">to</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number2 index1 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div><div class="line number3 index2 alt2"><code class="sql plain">mysql&gt; show grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number4 index3 alt1"><code class="sql plain">+</code><code class="sql comments">--------------------------------------------------+</code></div><div class="line number5 index4 alt2"><code class="sql plain">| Grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number6 index5 alt1"><code class="sql plain">+</code><code class="sql comments">--------------------------------------------------+</code></div><div class="line number7 index6 alt2"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql plain">PROCESS, SUPER </code><code class="sql keyword">ON</code> <code class="sql plain">*.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code> <code class="sql plain">|</code></div><div class="line number8 index7 alt1"><code class="sql plain">+</code><code class="sql comments">--------------------------------------------------+</code></div><div class="line number9 index8 alt2"><code class="sql plain">1 row </code><code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（3）</strong>重新kill root的进程成功：</span></span></div>
</div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_478171"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -ucqh</code></div><div class="line number2 index1 alt1"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number3 index2 alt2"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">40</code></div><div class="line number4 index3 alt1"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number5 index4 alt2"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number7 index6 alt2"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number8 index7 alt1"><code class="sql plain">owners.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number10 index9 alt1"><code class="sql plain">mysql&gt; show processlist;</code></div><div class="line number11 index10 alt2"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number12 index11 alt1"><code class="sql plain">| Id | </code><code class="sql color2">User</code> <code class="sql plain">| Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | db&nbsp;&nbsp;&nbsp; | Command | </code><code class="sql keyword">Time</code> <code class="sql plain">|
 
State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 | 
Info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number13 index12 alt2"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number14 index13 alt1"><code class="sql plain">|
 26 | root | localhost | mysql | Sleep&nbsp;&nbsp; |&nbsp;&nbsp; 20 
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 | </code><code class="sql color1">NULL</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 <code class="sql plain">|</code></div><div class="line number15 index14 alt2"><code class="sql plain">| 27 | root | localhost | </code><code class="sql color1">NULL</code>&nbsp; <code class="sql plain">| Query&nbsp;&nbsp; |&nbsp;&nbsp; 15 | Waiting </code><code class="sql keyword">for</code> <code class="sql keyword">table</code> <code class="sql keyword">level</code> <code class="sql plain">lock | </code><code class="sql keyword">set</code> <code class="sql keyword">password</code><code class="sql plain">=</code><code class="sql keyword">password</code><code class="sql plain">(</code><code class="sql string">'123'</code><code class="sql plain">) |</code></div><div class="line number16 index15 alt1"><code class="sql plain">| 31 | cqh&nbsp; | localhost | </code><code class="sql color1">NULL</code>&nbsp; <code class="sql plain">| Query&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; 0 | </code><code class="sql color1">NULL</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 <code class="sql plain">| show processlist&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number17 index16 alt2"><code class="sql plain">+</code><code class="sql comments">----+------+-----------+-------+---------+------+------------------------------+------------------------------+</code></div><div class="line number18 index17 alt1"><code class="sql plain">3 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div><div class="line number19 index18 alt2"><code class="sql plain">mysql&gt; kill 27;</code></div><div class="line number20 index19 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 从上面的例子中，可以看到FILE、PROCESS、SUPER三个管理权限可能会带来的安全隐患，因此除了管理员外，不要把这些权限赋予给普通用户。</span></div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp;</span></div>
<h3><span style="font-family: 微软雅黑;"><strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 7.LOAD DATA LOCAL带来的安全问题</span></strong></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; LOAD DATA默认读的是服务器上的文件，但是加上LOCAL参数后，就可以将本地具有访问权限的文件加载到数据库中。这在在带来方便的同时，可带来了以下安全问题。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">可以任意加载本地文件到数据库。</span></div>
<div><span style="font-family: 微软雅黑;">在Web环境中，客户从Web服务器连接，用户可以使用LOAD 
DATA 
LOCAL语句来读取Web服务器进程在读访问权限的任何文件（假定用户可以运行SQL服务器的任何命令）。在这种环境中，MySQL服务器的客户实际上
的是Web服务器，而不是连接Web服务器的用户运行的程序。</span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 解决的方法是，可以用--local-infile=0选项启动mysqld从服务器禁用所有LOAD DATA LOCAL命令。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 
对于mysql命令行客户端，可以通过指定--local-infile[=1]选项启用LOAD DATA 
LOCAL，或通过--local-infile=0选项禁用。类似地，对于mysqlimport，--local or 
-L选项启用本地文件装载。在任何情况下，成功进行本地装载需要服务器启用相关选项。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp;</span></div>
<h3><span style="font-family: 微软雅黑;"><strong>&nbsp; &nbsp; 8.DROP TABLE命令并不收回以前的相关访问权限</strong></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; DROP表的时候，其他用户对此表的权限并没有被收回，这样导致重新创建同名的表时，以前其他用户对此表的权限会自动自动赋予，进而产生权限外流。因此，在删除表时，要同时取消其他用户在此表上的相应权限。</span><span style="font-family: 微软雅黑;"><strong><br></strong></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 下面的例子说明了不收回相关访问授权的隐患。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（1）</strong>用root创建用户cqh，授权test下所有表的select权限：</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_655961"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">grant</code> <code class="sql keyword">select</code> <code class="sql keyword">on</code> <code class="sql plain">test.* </code><code class="sql keyword">to</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number2 index1 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div><div class="line number3 index2 alt2"><code class="sql plain">mysql&gt; show grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number4 index3 alt1"><code class="sql plain">+</code><code class="sql comments">-----------------------------------------------+</code></div><div class="line number5 index4 alt2"><code class="sql plain">| Grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number6 index5 alt1"><code class="sql plain">+</code><code class="sql comments">-----------------------------------------------+</code></div><div class="line number7 index6 alt2"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql plain">USAGE </code><code class="sql keyword">ON</code> <code class="sql plain">*.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="sql plain">|</code></div><div class="line number8 index7 alt1"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql keyword">SELECT</code> <code class="sql keyword">ON</code> <code class="sql plain">`test`.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code> <code class="sql plain">|</code></div><div class="line number9 index8 alt2"><code class="sql plain">+</code><code class="sql comments">-----------------------------------------------+</code></div><div class="line number10 index9 alt1"><code class="sql plain">2 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（2）</strong>cqh登录，测试权限：</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_70391"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -ucqh</code></div><div class="line number2 index1 alt1"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number3 index2 alt2"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">287</code></div><div class="line number4 index3 alt1"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number5 index4 alt2"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number7 index6 alt2"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number8 index7 alt1"><code class="sql plain">owners.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number10 index9 alt1"><code class="sql plain">mysql&gt; use test;</code></div><div class="line number11 index10 alt2"><code class="sql keyword">Database</code> <code class="sql plain">changed</code></div><div class="line number12 index11 alt1"><code class="sql plain">mysql&gt; show tables;</code></div><div class="line number13 index12 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number14 index13 alt1"><code class="sql plain">| Tables_in_test |</code></div><div class="line number15 index14 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number16 index15 alt1"><code class="sql plain">| menu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number17 index16 alt2"><code class="sql plain">| salary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number18 index17 alt1"><code class="sql plain">| t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number19 index18 alt2"><code class="sql plain">| t1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number20 index19 alt1"><code class="sql plain">| t12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number21 index20 alt2"><code class="sql plain">| t2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number22 index21 alt1"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number23 index22 alt2"><code class="sql plain">6 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（3）</strong>root登录，删除表t12：</span></span></div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_499457"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -uroot -p</code></div><div class="line number2 index1 alt1"><code class="sql plain">Enter </code><code class="sql keyword">password</code><code class="sql plain">: </code></div><div class="line number3 index2 alt2"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number4 index3 alt1"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">288</code></div><div class="line number5 index4 alt2"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number6 index5 alt1"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number7 index6 alt2"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number8 index7 alt1"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number9 index8 alt2"><code class="sql plain">owners.</code></div><div class="line number10 index9 alt1"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number11 index10 alt2"><code class="sql plain">mysql&gt; use test;</code></div><div class="line number12 index11 alt1"><code class="sql keyword">Database</code> <code class="sql plain">changed</code></div><div class="line number13 index12 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">drop</code> <code class="sql keyword">table</code> <code class="sql plain">t12;</code></div><div class="line number14 index13 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（4）</strong>cqh登录，再次测试权限：</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_297175"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -ucqh</code></div><div class="line number2 index1 alt1"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number3 index2 alt2"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">290</code></div><div class="line number4 index3 alt1"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number5 index4 alt2"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number7 index6 alt2"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number8 index7 alt1"><code class="sql plain">owners.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number10 index9 alt1"><code class="sql plain">mysql&gt; use test;</code></div><div class="line number11 index10 alt2"><code class="sql keyword">Database</code> <code class="sql plain">changed</code></div><div class="line number12 index11 alt1"><code class="sql plain">mysql&gt; show tables;</code></div><div class="line number13 index12 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number14 index13 alt1"><code class="sql plain">| Tables_in_test |</code></div><div class="line number15 index14 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number16 index15 alt1"><code class="sql plain">| menu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number17 index16 alt2"><code class="sql plain">| salary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number18 index17 alt1"><code class="sql plain">| t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number19 index18 alt2"><code class="sql plain">| t1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number20 index19 alt1"><code class="sql plain">| t2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number21 index20 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number22 index21 alt1"><code class="sql plain">5 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（5）</strong>此时t12表已经看不到了。</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_102645"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; show grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number2 index1 alt1"><code class="sql plain">+</code><code class="sql comments">-----------------------------------------------+</code></div><div class="line number3 index2 alt2"><code class="sql plain">| Grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number4 index3 alt1"><code class="sql plain">+</code><code class="sql comments">-----------------------------------------------+</code></div><div class="line number5 index4 alt2"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql plain">USAGE </code><code class="sql keyword">ON</code> <code class="sql plain">*.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="sql plain">|</code></div><div class="line number6 index5 alt1"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql keyword">SELECT</code> <code class="sql keyword">ON</code> <code class="sql plain">`test`.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code> <code class="sql plain">|</code></div><div class="line number7 index6 alt2"><code class="sql plain">+</code><code class="sql comments">-----------------------------------------------+</code></div><div class="line number8 index7 alt1"><code class="sql plain">2 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 权限仍然显示对test下所有表的有SELECT权限（安全漏洞）</span></div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（6）</strong>root再次登录，创建表t12:</span></span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_78190"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -uroot -p</code></div><div class="line number2 index1 alt1"><code class="sql plain">Enter </code><code class="sql keyword">password</code><code class="sql plain">: </code></div><div class="line number3 index2 alt2"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number4 index3 alt1"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">292</code></div><div class="line number5 index4 alt2"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number6 index5 alt1"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number7 index6 alt2"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number8 index7 alt1"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number9 index8 alt2"><code class="sql plain">owners.</code></div><div class="line number10 index9 alt1"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number11 index10 alt2"><code class="sql plain">mysql&gt; use test;</code></div><div class="line number12 index11 alt1"><code class="sql keyword">Database</code> <code class="sql plain">changed</code></div><div class="line number13 index12 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">create</code> <code class="sql keyword">table</code> <code class="sql plain">t12(id </code><code class="sql keyword">int</code><code class="sql plain">);</code></div><div class="line number14 index13 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.03 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;<span class="Apple-converted-space">&nbsp;<strong>（7）</strong>cqh登录，对t1权限依旧存在：</span></span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_960697"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -ucqh</code></div><div class="line number2 index1 alt1"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number3 index2 alt2"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">293</code></div><div class="line number4 index3 alt1"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number5 index4 alt2"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number7 index6 alt2"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number8 index7 alt1"><code class="sql plain">owners.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number10 index9 alt1"><code class="sql plain">mysql&gt; use test;</code></div><div class="line number11 index10 alt2"><code class="sql keyword">Database</code> <code class="sql plain">changed</code></div><div class="line number12 index11 alt1"><code class="sql plain">mysql&gt; show tables;</code></div><div class="line number13 index12 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number14 index13 alt1"><code class="sql plain">| Tables_in_test |</code></div><div class="line number15 index14 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number16 index15 alt1"><code class="sql plain">| menu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number17 index16 alt2"><code class="sql plain">| salary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number18 index17 alt1"><code class="sql plain">| t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number19 index18 alt2"><code class="sql plain">| t1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number20 index19 alt1"><code class="sql plain">| t12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number21 index20 alt2"><code class="sql plain">| t2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number22 index21 alt1"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number23 index22 alt2"><code class="sql plain">6 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 因此，对表做删除后，其他用户对此表的权限不会自动收回，一定要记住手工收回。</span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp;&nbsp;</span><span style="font-family: 微软雅黑;"><br></span></div>
<h3><span style="font-family: 微软雅黑;"><strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; 9.使用SSL</span></strong></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; SSL（Secure Socket 
Layer，安全套接字层）是一种安全传输的协议，最初Netscape公司所开发，用以保障在Internet上数据传输之安全，利用 
数据加密（Encryption）技术，可确保数据在网络上传输过程中不会被截取及窃听。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; SSL协议提供的服务主要有：</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; （1）认证用户和服务器，确保数据发送到正确的客户机和服务器；</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; （2）加密数据以防止数据中途被窃取；</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; （3）维护数据的完整性，确保数据在传输过程中不被改变。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 在MySQL中，要想使用SSL进行安全传输，需要在命令行中或选项文件中设置“--ssl”选项。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 
对于服务器，“ssl”选项规定该服务器允许SSL连接。对于客户端端程序，它允许客户使用SSL连接。对于客户端程序，它允许客户端用SSL连接服务
器。单单该选项不足以使用SSL连接。还必须指定--ssl-ca、--ssl-cert和--ssl-key选项。如果不想启用SSL，可以将选项指定
为--skip-ssl或--ssl=0。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 请注意，如果编译的服务器或客户端不支持SSL，则使用普通的示加密的连接。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 确保使用SSL连接的安全方式是，使用含REQUIRE SSL子句的GRANT语句在服务器上创建一账户，然后使用该账户来连接服务器，服务器和客户端均应启用SSL支持。下面例子创建了一个含REQUIRE SSL子句的账号：</span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_536347"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">grant</code> <code class="sql keyword">select</code> <code class="sql keyword">on</code> <code class="sql plain">*.* </code><code class="sql keyword">to</code> <code class="sql plain">cqh identified </code><code class="sql keyword">by</code> <code class="sql string">'123'</code> <code class="sql plain">REQUIRE ssl;</code></div><div class="line number2 index1 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div>
<ul>
<li>--ssl-ca=file_name<span style="font-family: 微软雅黑;">&nbsp; &nbsp; 含可信的SSL CA的清单的文件的路径</span></li>
<li>--ssl-cert=file_name<span style="font-family: 微软雅黑;">&nbsp; &nbsp; SSL证书文件名，用于建立安全连接</span></li>
<li>--ssl-key=file_name<span style="font-family: 微软雅黑;">&nbsp; &nbsp; SSL密钥文件名，用于建立 安全连接</span></li>
</ul>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp;</span></div>
<h3><span style="font-family: 微软雅黑;"><span data-wiz-span="data-wiz-span"><strong>&nbsp; &nbsp; 10.如果可能，给所有用户加上访问IP限制</strong></span></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 对数据库来说，我们希望客户端过来的连接都是安全的，因此，就很有必要在创建用户的时候指定可以进行连接的服务器IP或者HOSTNAME，只有符合授权的IP或者HOSTNAME才可以进行数据库的访问。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp;</span></div>
<h3><span style="font-family: 微软雅黑;"><span data-wiz-span="data-wiz-span"><strong>&nbsp; &nbsp; 11.REVOKE命令的漏洞</strong></span></span><span style="font-family: 微软雅黑;"><br></span></h3>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 当用户多次赋予权限后，由于各种原因，需要将此用户的权限全部取消，此时，REVOKE命令可能并不会按照我们的意愿执行，来看看下面的例子。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; （1）连续赋予用户两次权限，其中，第2次是对所有数据库的所有权限。</span><span style="font-family: 微软雅黑;"><br></span></div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_571089"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">grant</code> <code class="sql keyword">select</code><code class="sql plain">,</code><code class="sql keyword">insert</code> <code class="sql keyword">on</code> <code class="sql plain">test.* </code><code class="sql keyword">to</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number2 index1 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div><div class="line number3 index2 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">grant</code> <code class="sql color1">all</code> <code class="sql keyword">privileges</code> <code class="sql keyword">on</code> <code class="sql plain">*.* </code><code class="sql keyword">to</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number4 index3 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div><div class="line number5 index4 alt2"><code class="sql plain">mysql&gt; show grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number6 index5 alt1"><code class="sql plain">+</code><code class="sql comments">-------------------------------------------------------+</code></div><div class="line number7 index6 alt2"><code class="sql plain">| Grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number8 index7 alt1"><code class="sql plain">+</code><code class="sql comments">-------------------------------------------------------+</code></div><div class="line number9 index8 alt2"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql color1">ALL</code> <code class="sql keyword">PRIVILEGES</code> <code class="sql keyword">ON</code> <code class="sql plain">*.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="sql plain">|</code></div><div class="line number10 index9 alt1"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql keyword">SELECT</code><code class="sql plain">, </code><code class="sql keyword">INSERT</code> <code class="sql keyword">ON</code> <code class="sql plain">`test`.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code> <code class="sql plain">|</code></div><div class="line number11 index10 alt2"><code class="sql plain">+</code><code class="sql comments">-------------------------------------------------------+</code></div><div class="line number12 index11 alt1"><code class="sql plain">2 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; （2）此时，需要取消用户的所有权限。</span></div>
</div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_548507"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; </code><code class="sql keyword">revoke</code> <code class="sql color1">all</code> <code class="sql keyword">privileges</code> <code class="sql keyword">on</code> <code class="sql plain">*.* </code><code class="sql keyword">from</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number2 index1 alt1"><code class="sql plain">Query OK, 0 </code><code class="sql keyword">rows</code> <code class="sql plain">affected (0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; （3）我们很可能以为，此时用户已经没有任何权限了，而不会再去查看他的权限表。而实际上，此时的用户依然拥有test上的SELECT和INSERT权限。</span></div>
</div>
<div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_386091"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">mysql&gt; show grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost;</code></div><div class="line number2 index1 alt1"><code class="sql plain">+</code><code class="sql comments">-------------------------------------------------------+</code></div><div class="line number3 index2 alt2"><code class="sql plain">| Grants </code><code class="sql keyword">for</code> <code class="sql plain">cqh@localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 |</code></div><div class="line number4 index3 alt1"><code class="sql plain">+</code><code class="sql comments">-------------------------------------------------------+</code></div><div class="line number5 index4 alt2"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql plain">USAGE </code><code class="sql keyword">ON</code> <code class="sql plain">*.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="sql plain">|</code></div><div class="line number6 index5 alt1"><code class="sql plain">| </code><code class="sql keyword">GRANT</code> <code class="sql keyword">SELECT</code><code class="sql plain">, </code><code class="sql keyword">INSERT</code> <code class="sql keyword">ON</code> <code class="sql plain">`test`.* </code><code class="sql keyword">TO</code> <code class="sql string">'cqh'</code><code class="sql plain">@</code><code class="sql string">'localhost'</code> <code class="sql plain">|</code></div><div class="line number7 index6 alt2"><code class="sql plain">+</code><code class="sql comments">-------------------------------------------------------+</code></div><div class="line number8 index7 alt1"><code class="sql plain">2 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; （4）此时，再次用cqh登录，测试一下是否能对test数据库做操作。</span></div>
<div>
<div class="linenums">
<div class="cnblogs_Highlighter sh-gutter">
<div><div class="syntaxhighlighter  sql" id="highlighter_741773"><div class="toolbar"><span><a class="toolbar_item command_help help" href="#">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql plain">[root@iZ28dr6w0qvZ ~]# mysql -ucqh</code></div><div class="line number2 index1 alt1"><code class="sql plain">Welcome </code><code class="sql keyword">to</code> <code class="sql plain">the MySQL monitor.&nbsp; Commands </code><code class="sql keyword">end</code> <code class="sql keyword">with</code> <code class="sql plain">; </code><code class="sql color1">or</code> <code class="sql plain">\g.</code></div><div class="line number3 index2 alt2"><code class="sql plain">Your MySQL </code><code class="sql keyword">connection</code> <code class="sql plain">id </code><code class="sql keyword">is</code> <code class="sql plain">395</code></div><div class="line number4 index3 alt1"><code class="sql plain">Server version: 5.5.37-log MySQL Community Server (GPL)</code></div><div class="line number5 index4 alt2"><code class="sql plain">Copyright (c) 2000, 2014, Oracle </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its affiliates. </code><code class="sql color1">All</code> <code class="sql plain">rights reserved.</code></div><div class="line number6 index5 alt1"><code class="sql plain">Oracle </code><code class="sql keyword">is</code> <code class="sql plain">a registered trademark </code><code class="sql keyword">of</code> <code class="sql plain">Oracle Corporation </code><code class="sql color1">and</code><code class="sql plain">/</code><code class="sql color1">or</code> <code class="sql plain">its</code></div><div class="line number7 index6 alt2"><code class="sql plain">affiliates. Other names may be trademarks </code><code class="sql keyword">of</code> <code class="sql plain">their respective</code></div><div class="line number8 index7 alt1"><code class="sql plain">owners.</code></div><div class="line number9 index8 alt2"><code class="sql plain">Type </code><code class="sql string">'help;'</code> <code class="sql color1">or</code> <code class="sql string">'\h'</code> <code class="sql keyword">for</code> <code class="sql plain">help. Type </code><code class="sql string">'\c'</code> <code class="sql keyword">to</code> <code class="sql plain">clear the </code><code class="sql keyword">current</code> <code class="sql plain">input statement.</code></div><div class="line number10 index9 alt1"><code class="sql plain">mysql&gt; use test;</code></div><div class="line number11 index10 alt2"><code class="sql keyword">Database</code> <code class="sql plain">changed</code></div><div class="line number12 index11 alt1"><code class="sql plain">mysql&gt; show tables;</code></div><div class="line number13 index12 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number14 index13 alt1"><code class="sql plain">| Tables_in_test |</code></div><div class="line number15 index14 alt2"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number16 index15 alt1"><code class="sql plain">| menu&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number17 index16 alt2"><code class="sql plain">| salary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number18 index17 alt1"><code class="sql plain">| t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number19 index18 alt2"><code class="sql plain">| t1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number20 index19 alt1"><code class="sql plain">| t12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number21 index20 alt2"><code class="sql plain">| t2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number22 index21 alt1"><code class="sql plain">+</code><code class="sql comments">----------------+</code></div><div class="line number23 index22 alt2"><code class="sql plain">6 </code><code class="sql keyword">rows</code> <code class="sql color1">in</code> <code class="sql keyword">set</code> <code class="sql plain">(0.00 sec)</code></div><div class="line number24 index23 alt1"><code class="sql plain">mysql&gt; </code><code class="sql keyword">insert</code> <code class="sql keyword">into</code> <code class="sql plain">t1 </code><code class="sql keyword">values</code> <code class="sql plain">(1);</code></div><div class="line number25 index24 alt2"><code class="sql plain">Query OK, 1 row affected (0.01 sec)</code></div></div></td></tr></tbody></table></div></div>
</div>
</div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp; &nbsp; 
这个是MySQL权限机制造成的隐患，在一个数据库上多次赋予权限，权限会自动合并；但是在多个数据库上多次赋予权限，每个数据库上都会认为是单独的一组
权限，必须在此数据库上用REVOKE命令来单进行权限收回，而 REVOKE ALL PRIVILEGES ON *.* 
并不会替用户自动完成这个情况。</span></div>
</div>
<div><span style="font-family: 微软雅黑;">&nbsp;</span></div>
<div>&nbsp;</div>
<div><span style="font-family: 微软雅黑;">到这里，就把衣钵都传给你们了，别忘了点个赞哦！~</span></div></div><div id="MySignature"></div>
<div class="clear"></div>



		</div>
		
	</div>

	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a>


	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright &copy;2015 雪山飞猪
	</div><!--end: footer -->
<!--end: home 自定义的最大容器 -->


</body></html>